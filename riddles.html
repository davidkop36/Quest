<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Andrey's Birthday Quest</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #050816;
      color: #f4f4f4;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }

    .container {
      max-width: 800px;
      width: 100%;
      padding: 24px;
      box-sizing: border-box;
    }

    h1 { text-align: center; margin-bottom: 8px; }

    .subtitle {
      text-align: center;
      font-size: 0.9rem;
      opacity: 0.75;
      margin-bottom: 24px;
    }

    .card {
      background: rgba(15, 23, 42, 0.95);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.45);
      border: 1px solid rgba(148, 163, 184, 0.3);
      backdrop-filter: blur(4px);
    }

    .input-row { display: flex; gap: 8px; margin-bottom: 8px; }

    input[type="text"] {
      flex: 1;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: #020617;
      color: #f9fafb;
      outline: none;
      font-size: 0.95rem;
    }

    button {
      padding: 10px 16px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.95rem;
      background: #22c55e;
      color: #020617;
    }

    .progress { font-size: 0.9rem; margin-bottom: 8px; opacity: 0.85; }
    .message { min-height: 1.2em; font-size: 0.85rem; margin-bottom: 16px; }
    .message.ok { color: #4ade80; }
    .message.error { color: #fb7185; }

    .tiles-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
      margin-top: 16px;
      margin-bottom: 12px;
    }

    .tile {
      border-radius: 12px;
      padding: 12px;
      background: radial-gradient(circle at top left, #1e293b, #020617);
      border: 1px dashed rgba(148, 163, 184, 0.6);
      min-height: 80px;
      position: relative;
      opacity: 0.3;
    }

    .tile::before {
      content: "???";
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      letter-spacing: 0.08em;
      color: rgba(148, 163, 184, 0.8);
    }

    .tile.revealed {
      opacity: 1;
      border-style: solid;
    }

    .tile.revealed::before { content: ""; }

    .tile-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      opacity: 0.7;
      margin-bottom: 4px;
    }

    .tile-text { font-size: 0.9rem; white-space: pre-wrap; }

    #final-section {
      margin-top: 20px;
      padding-top: 14px;
      border-top: 1px dashed rgba(148, 163, 184, 0.4);
      display: none;
    }

    .footer {
      text-align: center;
      font-size: 0.7rem;
      opacity: 0.55;
      margin-top: 12px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1><b>Andrey</b>'s Birthday Quest</h1>
    
    <div class="hint" style="text-align:center; margin-bottom: 12px;">
  <span style="color:red;">17</span><span style="color:violet;">12</span>2025
  </div>

    <div class="subtitle">
      Hey, you. Here are 8 riddles for you. Enter any codes you discover.<br>
      Solve enough, and the final secret will unlock. ~ 
    </div>

    <div class="card">
      <div class="input-row">
        <input id="code-input" type="text" placeholder="Type a code…" autocomplete="off">
        <button id="submit-btn">Unlock</button>
      </div>

      <div id="progress" class="progress"></div>
      <div id="message" class="message"></div>
      <div id="tiles-grid" class="tiles-grid"></div>

      <div id="final-section">
        <div id="final-title">Final Secret Unlocked</div>
        <div id="final-text"></div>
      </div>
    </div>

    <div class="footer">Hope you like it! ❤️</div>
  </div>

<script>
  const MIN_CODES_REQUIRED = 5;
  const FINAL_GATE_CODE = "225";
  const SECRET_GATE_CODE= "77856";
  const ENDING_PAGE = "./ending.html";
  const HIDDEN_PAGE = "./eye.html";

  const VALID_CODES = {
    "30": 0,
    "11": 1,
    "07112024": 2,
    "071124": 2,
    "07.11.2024": 2,
    "7112024": 2,
    "7.11.2024": 2,
    "SEVEN": 3,
    "7": 3,
    "120": 4,
    "51": 5,
        "51.5": 5,
        "51.51": 5,
        "51.507": 5,
        "51.5074": 5,
    "89664": 6,
    "1241436123654": 7,
    "1246342123654": 7,
    "225": -1
  };

  /* ---------- UNCHANGED ---------- */
  const TILE_TEXTS = [
    {
      label: "Fragment I",
      text: `Some numbers don’t need to be searched for.
They’re acquired quietly, one year at a time.

This one is brand new.
It’s simply where you are now.`
    },
    {
      label: "Fragment II",
      text: `Some numbers don’t need to be solved.
They are already written into your routine.

You pass this one at the beginning and the end of most days.
It’s part of coming and going.

Notice what marks the threshold.`
    },
    {
      label: "Fragment III",
      text: `Some numbers don’t come from thinking.
They come from living.

They are constants written into our histories —
days when a single decision quietly changed everything.

At least, it did for one very visible foreign guy.`
    },
    {
      label: "Fragment IV",
      text: `Some numbers are spelled out, answers <i>finder</i>.
The answer to this puzzle is simple — <i>genei</i>.

A useful tool for rephrasing and re-expressing the same information.
And yet, it also <b>reminds</b> you that you are <i>dealing</i>
with something that is not what it seems at first glance.

I know — <b>very</b> <i>nerd</i>-like of me.`
    },
    { label: "Fragment V", text: `And some numbers represent where experiences happen.
This one belongs to a place we returned to often  - to disappear for a couple of hours into someone else’s life… 

Including that time I completely failed at being inconspicuous.

You, being the veteran you are, don’t need WAZE to get there.
Still… this time, it might be useful...` },
    { label: "Fragment VI", text: `Some numbers are attached to geographic locations.
Not east. Not west, either.

But a place dear to your heart.
One you keep coming back to.
One you are happy to share with others —
to bring a piece of it with you
for people close to you.

With flavors of refreshment,
festivity,
and adventure.

Its longitude defines where it is.
Its latitude provides the answer.` },
    { label: "Fragment VII", text: `Some numbers are not encoded in riddles,
but rather in reality.

Cached in the memory of space and time,
they must be visited. 
<div style="font-size:1.0em; font-weight:600; white-space:nowrap; position:relative; z-index:9999; pointer-events:auto;">
  <a href="https://maps.app.goo.gl/dvVcuuNixT6JGe5fA"
     target="_blank"
     rel="noopener noreferrer"
     style="text-decoration:none; color:inherit; cursor:pointer; pointer-events:auto; display:inline-block;">
    Go to the park
  </a>
</div>

At the point of divergence you observe, you will converge to the solution.` },
    { label: "Fragment VIII", text: `And some numbers want to be found.
They encode the deepest mysteries of life.

From the tiniest quantum scales
to the vast pull of gravity across the cosmos…
how many orders of magnitude is that?

And at the exact midpoint, it’s us.
Still arguing about measurement.
Still wondering if an observer is required
for the collapse of the wave function —
for the creation of a new state after measurement.

There is only one way to know:
<div style="font-size:1.3em; font-weight:600; white-space:nowrap; position:relative; z-index:9999; pointer-events:auto;">
  <a href="hexagon.png"
     target="_blank"
     style="text-decoration:none; cursor:pointer; pointer-events:auto; display:inline-block;"
     onclick="window.open(this.href,'_blank'); return false;">
    <span style="color:rgb(255,80,80);">XXX</span><span style="color:rgb(80,255,80);">XXXX</span><span style="color:rgb(80,80,255);">XXXXXX</span>
  </a>
</div>
` }
  ];

  const FINAL_MESSAGE = `
      Good job Andrey! You’ve collected enough fragments.<br><br>
      <strong>Final riddle:</strong><br>
      But the last entry isn’t on this page.<br>
      It’s on a souvenir that still smells like a holiday.<br>
      One that screams adventurous, and yet is happy to sit still .<br><br>

      Together with one more thing.<br>
      Maybe we didn’t find any scorpions with it —<br>
      but you might find something else.<br><br>
    `;
  /* ---------- END UNCHANGED ---------- */

  const STORAGE_KEY = "andrey_birthday_quest_tiles_v1";

  const tilesGrid = document.getElementById("tiles-grid");
  const progressEl = document.getElementById("progress");
  const messageEl = document.getElementById("message");
  const finalSection = document.getElementById("final-section");
  const finalText = document.getElementById("final-text");
  const codeInput = document.getElementById("code-input");

  function loadUnlockedTiles() {
    try {
      const raw = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
      return new Set(raw.filter(n => Number.isInteger(n)));
    } catch {
      return new Set();
    }
  }

  function saveUnlockedTiles() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify([...unlockedTiles]));
  }

  let unlockedTiles = loadUnlockedTiles();

  function createTiles() {
    tilesGrid.innerHTML = "";
    TILE_TEXTS.forEach((t, i) => {
      const d = document.createElement("div");
      d.className = "tile";
      d.dataset.index = i;
      d.innerHTML =
        `<div class="tile-label">${t.label}</div>
         <div class="tile-text">${t.text}</div>`;
      tilesGrid.appendChild(d);
    });
  }

  function updateUI() {
    const count = unlockedTiles.size;
    const total = 8;

    progressEl.textContent =
      count === 0
        ? "You haven’t unlocked any clues yet."
        : `You’ve unlocked ${count} out of ${total} clues.`;

    document.querySelectorAll(".tile").forEach(t => t.classList.remove("revealed"));
    unlockedTiles.forEach(i => {
      const tile = document.querySelector(`.tile[data-index="${i}"]`);
      if (tile) tile.classList.add("revealed");
    });

    if (count >= MIN_CODES_REQUIRED) {
      finalSection.style.display = "block";
      finalText.innerHTML = FINAL_MESSAGE;
    } else {
      finalSection.style.display = "none";
    }
  }

  function submitCode() {
    const code = codeInput.value.trim().toUpperCase();
    codeInput.value = "";

    if (code === FINAL_GATE_CODE) {
      window.location.href = ENDING_PAGE;
      return;
    }

      if (code === SECRET_GATE_CODE) {
      window.location.href = HIDDEN_PAGE;
      return;
    }

    if (!(code in VALID_CODES)) {
      messageEl.textContent = "That doesn’t seem to be a valid code.";
      messageEl.className = "message error";
      return;
    }

    const idx = VALID_CODES[code];
    if (idx < 0 || unlockedTiles.has(idx)) {
      messageEl.textContent = "You already unlocked this fragment.";
      messageEl.className = "message error";
      return;
    }

    unlockedTiles.add(idx);
    saveUnlockedTiles();
    messageEl.textContent = "Code accepted. A new fragment has been unlocked.";
    messageEl.className = "message ok";
    updateUI();
  }

  document.getElementById("submit-btn").onclick = submitCode;
  codeInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    e.preventDefault();
    submitCode();
  }
});


  createTiles();
  updateUI();
</script>
</body>
</html>
